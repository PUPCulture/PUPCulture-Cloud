# PupCulture Cloud

PupCulture Cloud is a self-hosted, containerized backend platform designed for:

- Real-time data storage and messaging
- Bot-centric workloads (Discord, Telegram, and custom bots)
- API key–secured access and multi-tenant bot integration
- Web-based administrative control and observability

The system is designed to be deployed behind **Cloudflare Tunnel** and accessed via your own domain, e.g.:

- `admin.pupculture.site` – Admin UI
- `api.pupculture.site` – REST/HTTP API
- `ws.pupculture.site` – WebSocket endpoint
- `files.pupculture.site` – Object storage (MinIO)

---

## High-Level Architecture

The stack is composed of the following services (via `docker-compose`):

- **API (`api`)**
  - Node.js (Express)
  - REST endpoints for admin, bots, API keys, and rules
  - WebSocket server for real-time events
  - Discord and Telegram integration points
  - Uses Postgres, Redis, MinIO

- **Admin UI (`adminui`)**
  - React + Vite build, served by Nginx
  - Connects to API via `/admin-api/*` proxy
  - Provides admin login, stats, API key management, bot listing (and can be extended)

- **Postgres (`db`)**
  - Primary database (users, bots, messages, API keys, etc.)

- **Redis (`redis`)**
  - Ephemeral storage, suitable for presence, sessions, rate limiting, etc.

- **MinIO (`minio`)**
  - S3-compatible object storage for files, attachments, and bot data blobs

- **Cloudflare Tunnel (`cloudflared`)**
  - Secure ingress from the public internet to internal Docker services
  - No open ports required on the host

All services are contained within an internal Docker network and exposed externally only through Cloudflare.

---

## Repository Structure

```text
pupculture-cloud/
├── docker-compose.yml
├── README.md
│
├── cloudflare/
│   ├── config.yml                 # Cloudflare Tunnel ingress config
│   └── pupculture-admin.json      # Tunnel credentials (generated by Cloudflare)
│
├── api/
│   ├── Dockerfile
│   ├── package.json
│   ├── .env.example
│   └── src/
│       ├── server.js              # API entrypoint
│       ├── auth.js                # Admin JWT handling
│       ├── rules.js               # Rules engine scaffold
│       ├── ws.js                  # WebSocket server setup
│       ├── discord.js             # Discord bridge (optional)
│       ├── telegram.js            # Telegram bridge (optional)
│       ├── bots/
│       │   └── sdk.js             # Bot bootstrap / auto-registration client
│       └── routes/
│           ├── admin.js           # Admin login & stats
│           ├── apiKeys.js         # API key CRUD
│           ├── bots.js            # Bot registration & listing
│           └── rules.js           # Rules read/write endpoints (to be extended)
│
├── adminui/
│   ├── Dockerfile
│   ├── nginx.conf                 # Nginx proxy + SPA configuration
│   ├── package.json
│   ├── vite.config.mts
│   ├── index.html
│   └── src/
│       ├── main.tsx               # React entry
│       ├── App.tsx                # Routing and layout shell
│       ├── api.ts                 # Admin API client wrapper
│       └── routes/
│           ├── Login.tsx
│           ├── Dashboard.tsx
│           ├── Bots.tsx           # (stub or to be implemented)
│           ├── ApiKeys.tsx        # (stub or to be implemented)
│           └── Rules.tsx          # (stub or to be implemented)
│
└── bots/
    └── template/
        ├── package.json           # Example bot project
        ├── bot.json               # Example metadata
        ├── index.js               # Example auto-registering bot
        └── README.md
